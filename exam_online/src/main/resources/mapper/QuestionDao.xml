<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.wzy.exam_online.dao.QuestionDao">


<select id="makeQuestionList" parameterType="list" resultType="question">
    select * from question
        <if test="qids !=null and qids.size()>0">
            where qid in
            <foreach collection="qids" item="qid" open="(" close=")" separator=",">
                #{qid}
            </foreach>
            GROUP BY type_id,qid ORDER BY type_id
        </if>

</select>
    <select id="getQuestionsIdByCid" parameterType="list" resultType="java.lang.Integer">
        select qid from question
        <if test="cids !=null and cids.size()>0">
            where catalog_id in
            <foreach collection="cids" item="cid" open="(" close=")" separator=",">
                #{cid}
            </foreach>
        </if>
    </select>
    <select id="getAnswerByQid" parameterType="list" resultType="myAnswer">
        select qid,answer as my_answer from question
        <if test="qids !=null and qids.size()>0">
            where qid in
            <foreach collection="qids" item="qid" open="(" close=")" separator=",">
                #{qid}
            </foreach>
        </if>
    </select>

    <select id="getLastExam" parameterType="integer" resultType="question">
        select question.* ,my_answer,t_f from question,my_answer where question.qid=my_answer.qid
        and pid =#{pid}
        GROUP BY type_id,qid ORDER BY type_id;

    </select>
    <select id="getWrongQuestion" resultType="com.wzy.exam_online.bean.Question">
        SELECT b.* FROM
        (select distinct question.* ,my_answer,create_time from question JOIN my_answer ON question.qid=my_answer.qid JOIN paper on
        my_answer.pid =paper.pid and t_f =0) a LEFT JOIN
        (select distinct question.* ,my_answer,create_time from question JOIN my_answer ON question.qid=my_answer.qid JOIN paper on
        my_answer.pid =paper.pid ) b
        ON a.qid = b.qid AND a.create_time &lt;= b.create_time
        GROUP BY a.qid,a.create_time
        HAVING count(a.qid) &lt; 2

    </select>
</mapper>